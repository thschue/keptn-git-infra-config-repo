apiVersion: "spec.keptn.sh/0.2.0"
kind: "Shipyard"
metadata:
  name: "platform-infrastructure"
spec:
  stages:
    - name: "dev"
      sequences:
        - name: "artifact-delivery"
          tasks:
            - name: "promotion"
            - name: "platform-setup"
            - name: "infra-version"
    - name: "staging"
      sequences:
        - name: "artifact-delivery"
          triggeredOn:
            - event: "dev.artifact-delivery.finished"
          tasks:
            - name: "promotion"
            - name: "platform-setup"
            - name: "infra-version"

    - name: "production"
      sequences:
        - name: "artifact-delivery"
          triggeredOn:
            - event: "staging.artifact-delivery.finished"
          tasks:
            - name: approval
              properties:
                pass: manual
                warning: manual
            - name: "promotion"
            - name: "infrastructure-delivery"
            - name: "infra-version"
